/** * @author Alexsab.ru */
document.addEventListener("DOMContentLoaded",function(){var e=[].slice.call(document.querySelectorAll("img.lazy")),t=[].slice.call(document.querySelectorAll(".lazy-background")),o=[].slice.call(document.querySelectorAll("[data-bg]"));if("IntersectionObserver"in window){let n=new IntersectionObserver(function(e,t){e.forEach(function(e){if(e.isIntersecting){let t=e.target;t.src=t.dataset.src,t.srcset=t.dataset.srcset,t.classList.remove("lazy"),n.unobserve(t)}})});e.forEach(function(e){n.observe(e)});let r=new IntersectionObserver(function(e,t){e.forEach(function(e){e.isIntersecting&&(e.target.classList.add("visible"),r.unobserve(e.target))})});t.forEach(function(e){r.observe(e)});let i=new IntersectionObserver(function(e,t){e.forEach(function(e){if(e.isIntersecting){let t=e.target;t.style.backgroundImage="url("+t.dataset.bg+")",i.unobserve(t)}})});o.forEach(function(e){i.observe(e)})}else e.forEach(function(e){e.src=e.dataset.src,e.srcset=e.dataset.srcset}),t.forEach(function(e){e.classList.add("visible")}),o.forEach(function(e){e.style.backgroundImage="url("+e.dataset.bg+")"})}),document.addEventListener("DOMContentLoaded",function(){var e=function(e){return document.querySelector(e)},t=function(e){return document.querySelectorAll(e)},o=e("#scrolltop");if(window.onscroll=function(){document.body.scrollTop>200||document.documentElement.scrollTop>200?o.style.display="block":o.style.display="none"},o.addEventListener("click",function(e){window.scrollTo({top:0,behavior:"smooth"})}),window.cars){(r=window.cars).sort(function(e,t){return e.price-t.price});var n=e(".kdx-ui-list__cell");n.parentNode.removeChild(n)}if(t(".kdx-ui-list__cell").forEach(function(e){i(e.querySelector(".item-slider").getAttribute("data-fancybox-trigger"),e.querySelector(".item-slider").getAttribute("data-images"),e.querySelector(".item").getAttribute("id"),e.querySelector(".item-slider").getAttribute("data-count"),e.querySelector(".item-slider").getAttribute("data-avito")),a("#"+e.getAttribute("id")+" .reserve-btn",e.querySelector(".replace-name").textContent.replace(/[\n\r]+|[\s]{2,}/g," ").trim(),e.querySelector(".replace-year").innerText,e.querySelector(".replace-price").innerText),a("#"+e.getAttribute("id")+" .replace-name",e.querySelector(".replace-name").textContent.replace(/[\n\r]+|[\s]{2,}/g," ").trim(),e.querySelector(".replace-year").innerText,e.querySelector(".replace-price").innerText),e.addEventListener("click",function(e){})}),$(".kdx-ui-location").fancybox({type:"html",src:'<div class="fc-content p-5 rounded">\t\t        <div id="map-here"></div>\t        </div>',touch:{vertical:!1,momentum:!1},baseClass:"fancybox-slide--map",afterShow:function(e,t){var o;ym("55810999","reachGoal","show_map"),ym("55834846","reachGoal","show_map"),ymaps.ready(function(){var e=new ymaps.Map("map-here",{center:[53.248313,50.2142483],zoom:14,controls:[]});e.behaviors.disable("scrollZoom"),o=new ymaps.Placemark([53.248313,50.2142483],{hintContent:"INFINITI Самарские автомобили",balloonContent:"<h2>INFINITI Самарские автомобили</h2> <p>г.Самара, Московское шоссе, 262</p> <p>+7 (846) 993 66 77</p>"},{preset:"islands#redAutoIcon"}),e.geoObjects.add(o)})}}),$("#filter_table"),"www.avito.ru"==location.host){const e=e=>{const t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)};var r=[];t(".catalog_table .item__line").forEach(function(e){var t=e.querySelector('span[itemprop="name"]').innerText,o=t.match(/(.*)?,/)[1],n=t.match(/, (\d+)/)[1],i=e.querySelector('span[itemprop="price"]').innerText.match(/\d+/g).join(""),a=e.querySelector(".specific-params").innerText,c=[];e.querySelectorAll(".item-slider .item-slider-image img").forEach(function(e){c.push(e.src.match(/(\d+)\.jpg/)[1])}),r.push({name:o,year:n,price:i,images:c,params:a})}),JSON.stringify(r),e(JSON.stringify(r)),window.prompt("Copy to clipboard: Ctrl+C (CMD+C), Enter",JSON.stringify(r)),console.log(JSON.stringify(r))}function i(e,t,o,n,r){let i=[];if(r)(t=t.split(",")).forEach(function(e){i.push({src:"https://98.img.avito.st/1280x960/"+e+".jpg"})});else{let e=0;for(;e<=n;)i.push({src:"/uploads/"+o+"/images/"+e+"-1920x1280.jpg"}),e++}$('[data-fancybox-trigger="'+e+'"]').on("click",function(){$.fancybox.open(i,{loop:!0,afterShow:function(e,t){ym("55810999","reachGoal","watch_gallery"),ym("55834846","reachGoal","watch_gallery")}})})}function a(e,t,o,n){$(e).on("click",function(){$("#reserve").find(".car").html(t),$("#contact").find("#carname").attr("value",t),$("#contact").find("#caryear").attr("value",o),$("#contact").find("#carprice").attr("value",n),$.fancybox.open({src:"#reserve",type:"inline",opts:{afterShow:function(e,t){ym("55810999","reachGoal","leed_form_open"),ym("55834846","reachGoal","leed_form_open")},beforeClose:function(e,t,o){}}}),$("#contact").submit(function(){return!1})})}e("#inputPhone").addEventListener("input",function(e){var t=this.value.replace("+7","").replace(/\D/g,"").split(/(?=.)/),o=t.length;0<=o&&t.unshift("+7"),1<=o&&t.splice(1,0," "),4<=o&&t.splice(5,0," "),7<=o&&t.splice(9,0,"-"),9<=o&&t.splice(12,0,"-"),11<=o&&t.splice(15,t.length-15),this.value=t.join("")}),$(document).ready(function(){$("#send").on("click",function(){var e=$("#inputName").val(),t=$("#inputPhone").val(),o=$("#politikaCheckbox").prop("checked"),n=e.length,r=t.length,i=/\+7 \(?\d{3}\)? \d{3}-?\d{2}-?\d{2}/.test(t);0==i&&r<16?($("#inputPhone").addClass("is-invalid"),$("#inputPhone").removeClass("is-valid")):1==i&&($("#inputPhone").addClass("is-valid"),$("#inputPhone").removeClass("is-invalid")),n<1?($("#inputName").addClass("is-invalid"),$("#inputName").removeClass("is-valid")):n>=1&&($("#inputName").addClass("is-valid"),$("#inputName").removeClass("is-invalid")),1==i&&n>=1&&o&&(ym("55810999","reachGoal","leed_form_sent"),ym("55834846","reachGoal","leed_form_sent"),$("#submit").replaceWith("<em>отправка...</em>"),$("#politikaCheckbox").attr("value",o),$.ajax({type:"POST",url:"mail.php",data:$("#contact").serialize(),success:function(e){"true"==e&&(ym("55810999","reachGoal","leed_form"),ym("55834846","reachGoal","leed_form"),$("#contact").fadeOut("fast",function(){$(this).before("<p><strong>Ваша заявка отправлена. Мы свяжемся с вами в ближайшее время.</strong></p>"),setTimeout("$.fancybox.close()",2e3)}))}}))});$(".cookie-more");var e=$(".cookie-agree"),t=$(".cookie");$(window).on("load",function(){var e,o;e="cookieAreShown",((o=document.cookie.match(new RegExp("(?:^|; )"+e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)")))?decodeURIComponent(o[1]):void 0)||t.addClass("is-show")}),e.on("click",function(e){e.preventDefault(),t.removeClass("is-show"),setTimeout(function(){!function(e,t,o){o=o||{},console.log(o);var n=o.expires;if("number"==typeof n&&n){var r=new Date;r.setTime(r.getTime()+1e3*n),n=o.expires=r}n&&n.toUTCString&&(o.expires=n.toUTCString());var i=e+"="+(t=encodeURIComponent(t));for(var a in o){i+="; "+a;var c=o[a];!0!==c&&(i+="="+c),console.log(i)}document.cookie=i}("cookieAreShown",!0),t.hide()},1200)})})});